webpackJsonp([4],{272:function(t,e,i){var n=i(273);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i(54)("66fddd46",n,!0,{})},273:function(t,e,i){e=t.exports=i(53)(!1),e.push([t.i,".user-info[data-v-272fc331]{background-color:#fff;padding:1em;font-size:.8em}.user-info-col[data-v-272fc331]{padding:1em 0}.user-info-avatar-wp[data-v-272fc331]{height:6rem;width:6rem;background-color:#eaeaea;text-align:center;line-height:6rem}.user-info-col-label[data-v-272fc331]{width:100px;padding-right:1em;text-align:right;-webkit-box-sizing:border-box;box-sizing:border-box}.user-info-col-content[data-v-272fc331],.user-info-col-label[data-v-272fc331]{display:inline-block;vertical-align:top}.user-info-avatar-wp img[data-v-272fc331]{height:100%;width:100%}.user-info-upload[data-v-272fc331]{margin-top:.5em;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.user-info-input[data-v-272fc331]{display:block;margin:.5em 0}.user-info-spliter[data-v-272fc331]{display:block;width:calc(100% - 100px);height:1px;margin-left:100px;background-color:#ccc}@media screen and (max-width:425px){.user-info-col-label[data-v-272fc331]{display:block;text-align:left;margin-bottom:1em}.user-info-spliter[data-v-272fc331]{width:100%;margin:0}.user-info-col-content[data-v-272fc331]{margin-left:1em}}",""])},55:function(t,e,i){"use strict";var n={name:"BaseInput",props:{showError:{type:Boolean,default:!0},type:{type:String,default:"text"},value:{type:[Number,String]},placeholder:{type:String},minlength:{type:Number},maxlength:{type:Number},validators:{validator:function(t){if(!Array.isArray(t))return!1;var e=!0;return t.forEach(function(t){Object.keys(t).forEach(function(t){["reg","errText","equalTo"].includes(t)||(e=!1)})}),e}}},data:function(){return{error:""}},methods:{handleChange:function(t){this.validators&&(this.error=this.validate(t),this.$emit("validation",this.error))},validate:function(t){var e="";return this.validators.some(function(i){var n=i.reg,a=i.errText,s=i.equalTo;return n&&!n.test(t)?(e=a,!0):!(!s||s===t)&&(e=a,!0)}),e},clearInput:function(){this.$emit("input",""),this.handleChange("")},clearError:function(){this.error=""}}},a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"base-input"},[i("div",{staticClass:"base-input__inner"},[i("input",{attrs:{type:t.type,placeholder:t.placeholder,minlength:t.minlength,maxlength:t.maxlength,autocomplete:""},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)},change:function(e){return t.handleChange(e.target.value)}}}),i("i",{directives:[{name:"show",rawName:"v-show",value:!!t.value,expression:"!!value"}],staticClass:"base-input__clear iconfont icon-error",on:{click:t.clearInput}})]),t._t("default"),i("transition",{attrs:{name:"zoom-in"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showError&&t.error,expression:"showError && error"}],staticClass:"base-input__info--error"},[i("i",{staticClass:"iconfont icon-error"}),t._v(t._s(t.error)+"\n    ")])])],2)},s=[],o={render:a,staticRenderFns:s},r=o,l=i(3),c=l(n,r,!1,null,null,null);e.a=c.exports},63:function(t,e,i){"use strict";function n(t){i(272)}Object.defineProperty(e,"__esModule",{value:!0});var a=i(55),s=i(14),o={name:"UserInfo",data:function(){return{oldPw:"",newPw:"",confirmNewPw:"",avatarSubmiting:!1,pwSubmiting:!1,oldPwValid:!1,newPwValid:!1,confirmNewPwValid:!1}},components:{BaseInput:a.a},computed:{user:function(){return this.$store.state.user},pwDisabled:function(){return!(this.oldPw&&this.newPw&&this.confirmNewPw&&this.oldPwValid&&this.newPwValid&&this.confirmNewPwValid)}},watch:{newPw:function(){this.confirmNewPw=""}},beforeRouteEnter:function(t,e,i){i(function(t){t.$store.commit("setPosition",[{title:"BLOG",route:"/blog"},{title:"个人信息",route:"",disabled:!0}])})},methods:{handleClick:function(){document.getElementById("avatar-upload").click()},changeFile:function(t){var e=this,i=t.target.files;i.length&&(this.submiting=!0,Object(s.o)(this.user.id,i[0]).then(function(t){var i=t.source;e.$store.commit("updateUser",{userPic:i.userPic}),e.submiting=!1}).catch(function(t){e.submiting=!1})),console.log(i)},updatePassword:function(){var t=this,e={id:this.user.id,oldPw:this.oldPw,newPw:this.newPw};this.pwSubmiting=!0,Object(s.n)(e).then(function(e){t.pwSubmiting=!1,t.oldPw="",t.newPw="",t.confirmNewPw=""}).catch(function(e){t.pwSubmiting=!1})}}},r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"user-info"},[i("div",{staticClass:"user-info-col"},[i("span",{staticClass:"user-info-col-label"},[t._v("用户名：")]),i("span",{staticClass:"user-info-col-content"},[t._v(t._s(t.user.username))])]),i("div",{staticClass:"user-info-col"},[i("span",{staticClass:"user-info-col-label"},[t._v("头像：")]),i("div",{staticClass:"user-info-col-content"},[i("div",{staticClass:"user-info-avatar-wp"},[t.user.userPic?i("img",{attrs:{src:t.user.userPic,alt:""}}):i("span",[t._v("无")])]),i("form",[i("button",{class:{"user-info-upload":!0,"is-disabled":t.avatarSubmiting},on:{click:function(e){return e.preventDefault(),t.handleClick(e)}}},[i("i",{directives:[{name:"show",rawName:"v-show",value:t.avatarSubmiting,expression:"avatarSubmiting"}],staticClass:"iconfont icon-loading-out"}),t._v("\n          "+t._s(t.avatarSubmiting?"上传中...":"上传图片")+"\n        ")]),i("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{id:"avatar-upload",type:"file"},on:{change:t.changeFile}})])])]),i("span",{staticClass:"user-info-spliter"}),i("div",{staticClass:"user-info-col"},[i("span",{staticClass:"user-info-col-label"},[t._v("修改密码：")]),i("form",{staticClass:"user-info-col-content"},[i("BaseInput",{staticClass:"user-info-input",attrs:{validators:[{reg:/^([A-Z]|[a-z]|[0-9]){6,18}$/,errText:"请输入正确的密码"}],type:"password",placeholder:"原密码"},on:{validation:function(e){return t.oldPwValid=!e}},model:{value:t.oldPw,callback:function(e){t.oldPw=e},expression:"oldPw"}},[i("div",{staticClass:"base-input__info"},[i("p",[i("i",{staticClass:"iconfont icon-warn"}),t._v("输入原来的密码。")])])]),i("BaseInput",{staticClass:"user-info-input",attrs:{validators:[{reg:/^([A-Z]|[a-z]|[0-9]){6,18}$/,errText:"请输入正确的密码"}],type:"password",placeholder:"新密码"},on:{validation:function(e){return t.newPwValid=!e}},model:{value:t.newPw,callback:function(e){t.newPw=e},expression:"newPw"}},[i("div",{staticClass:"base-input__info"},[i("p",[i("i",{staticClass:"iconfont icon-warn"}),t._v("输入新的密码。")]),i("p",[i("i",{staticClass:"iconfont icon-warn"}),t._v("包含英文、数字。")]),i("p",[i("i",{staticClass:"iconfont icon-warn"}),t._v("长度在6-18。")])])]),i("BaseInput",{staticClass:"user-info-input",attrs:{validators:[{equalTo:t.newPw,errText:"两次输入不一样！"}],type:"password",placeholder:"确认新密码"},on:{validation:function(e){return t.confirmNewPwValid=!e}},model:{value:t.confirmNewPw,callback:function(e){t.confirmNewPw=e},expression:"confirmNewPw"}},[i("div",{staticClass:"base-input__info"},[i("p",[i("i",{staticClass:"iconfont icon-warn"}),t._v("再次输入新的密码。")])])]),i("button",{class:{"is-disabled":t.pwSubmiting||t.pwDisabled},attrs:{disabled:t.pwDisabled,type:"submit"},on:{click:function(e){return e.preventDefault(),t.updatePassword(e)}}},[i("i",{directives:[{name:"show",rawName:"v-show",value:t.pwSubmiting,expression:"pwSubmiting"}],staticClass:"iconfont icon-loading-out"}),t._v("\n        修改密码\n      ")])],1)])])},l=[],c={render:r,staticRenderFns:l},u=c,d=i(3),f=n,p=d(o,u,!1,f,"data-v-272fc331",null);e.default=p.exports}});